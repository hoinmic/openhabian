val logName = "illumination"

var Timer timer = null

//------------------------------------------------------------
// Power switch changes
rule "Illumination Turn OFF"
when
  System started or
  Item floorlamp_switch changed to OFF
then
  floorlamp_switch.sendCommand(OFF)
  logInfo(logName, "Send command turn off")
end

rule "Turn ON Illumination"
when
  Item floorlamp_switch changed to ON
then
  floorlamp_switch.sendCommand(ON)
  logInfo(logName, "Send command turn on")
end

//------------------------------------------------------------
// Copy the Switched plug socket status
rule "Switched plug socket"
when
  System started or
  Item lamp_switch_network changed or
  Time cron "0 0/1 * * * ?"   // every minute
then
  if (lamp_switch_network.state.toString == "ON")
  {
    floorlamp_switch.postUpdate(ON)
    logInfo(logName, "Device: Power on")
  }
  else
  {
    floorlamp_switch.postUpdate(OFF)
    logInfo(logName, "Device: Power off")
  }
end

